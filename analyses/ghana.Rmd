---
title: "Ghana prediction"
output: html_document
---
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='Figs/',
                      warning=FALSE, message=FALSE)
knitr::opts_knit$set(root.dir="../")
```

```{r load_data, echo=FALSE}
library(MLlibrary)
library(dplyr)

NAME <- "ghana"
gh <- load_dataset(NAME)
```

## Data

This is a sample analysis of the ghana dataset from 2006.
The dataset has `r nrow(gh)` rows and `r ncol(gh)` columns.
TODO: how many missing?
Our goal is to predict the consumption levels from survey data.
In this case we take the log of per capita consumption as our target variable.

## Models

```{r load_models, echo=FALSE}
joined <- load_models(NAME)
k <- nrow(distinct(joined, fold))
```

We trained a number of different models on the raw data.
We use `r k=5` fold cross validation for testing predictive accuracy.

We also trained each model on a dataset including all pairwise interactions.

### Density
```{r density, echo=FALSE}
plot_density_(filter(filter(joined,method!="logistic"),method!="logistic_ix"))
```


### Reach vs waste
```{r reach_vs_waste, echo=FALSE}
plot_reach_vs_waste_(joined, POINT_COUNT=100)
```
```{r reach_vs_waste_0.4, echo=FALSE}
plot_reach_vs_waste_(joined, POINT_COUNT=1000, THRESHOLD = 0.4)
```

### Social welfare (gamma = 2)
```{r swf_2, echo=FALSE}
plot_swf_(joined, POINT_COUNT=1000, GAMMA = 2)
```

### Social welfare (gamma = 4)
```{r swf_4, echo=FALSE}
plot_swf_(joined, POINT_COUNT=1000, GAMMA = 4)
```
