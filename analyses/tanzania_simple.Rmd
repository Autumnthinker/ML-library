---
title: "Tanzania Prediction Example"
output:
  html_document
---
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='Figs/',
                      warning=FALSE, message=FALSE)
knitr::opts_knit$set(root.dir="../")
```

```{r load_data, echo=FALSE}
library(MLlibrary)
library(dplyr)

NAME <- "tanzania"
tz08 <- load_dataset(NAME)
```

## Data

This is a sample analysis of the tanzania dataset from 2008.
The dataset has `r nrow(tz08)` people and `r ncol(tz08)` variables.
`r nrow(tz08) - nrow(model.matrix(lconsPC ~ .,  tz08))` rows contain some missing data.
We ran models on the dataset without the missing data.
Our goal is to predict the consumption levels from survey data.
In this case we take the log of per capita consumption as our target variable.

## Models

```{r load_models, echo=FALSE}
all_models <- load_models(NAME)
k <- nrow(distinct(all_models, fold))
no_missing <- filter(all_models, !grepl("missing", method))
```

We trained a number of different models on the raw data.
We use `r k` fold cross validation for testing predictive accuracy.

We also trained each model on a dataset including all pairwise interactions.


## Assessments

### Density
```{r density, echo=FALSE}
no_logistic <- filter(no_missing, !grepl("logistic", method))
plot_density_(no_logistic)
```

### Reach vs Waste

```{r rvw, echo=FALSE}
plot_reach_vs_waste_(no_missing)
plot_reach_vs_waste_(no_missing, THRESHOLD=0.2)
```

### Social welfare
```{r swf, echo=FALSE}
plot_swf_(no_missing, POINT_COUNT=50)
```
